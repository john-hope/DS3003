---
title: "Create-Your-Own-Plot Assignment (4 pts per presentation date)"
author: "John Hope (jah9kqn)"
date: "Due Date: Feb 27th"
output:
  html_document:
    number_sections: yes
    toc: yes
    toc_float: yes
    code_folding: show
  pdf_document:
    toc: yes
---

<style>
h1.title {
  font-size: 30px;
}
h1 {
  font-size: 26px;
}
h2 {
  font-size: 22px;
}
h3 { 
  font-size: 18px;
}

</style>

# Assignment 8
 
## Create your own plots for two presentations on Feb 21 (4 pts)

### Presentation 1: The Economic Guide to Picking a College Major by Sarah Gould

This presentation focuses on the dillema of choosing the "right major" for college students. The main focus of the presentation is the popularity and future financial and occupational stability of different college majors. The plots included in the presentation were a scatterplot between unemployment and median earnings, a polar chart of major popularity, and different bar plots and box plots to show major earning distributions, with conditions for college degree status and gender. The main finding was the STEM major category being the most financially stable option, with the highest median earnings, and highest avoidance for unemployment.

```{r, warning=FALSE, message=FALSE}
# read library
library(tidyverse)

# Data read in / preperation
majors_raw <- read.csv("/Users/johnhope/Desktop/DS3003/Assignment 8/Data/recent-grads.csv")
majors_raw <- na.omit(majors_raw)
majors_raw$Median.45K <- ifelse(majors_raw$Median >= 45000, "GEQ.45K", "L.45K")
majors_raw$Major_Categories <- fct_collapse(majors_raw$Major_category,
                             Arts = c("Arts", "Humanities & Liberal Arts", "Industrial Arts & Consumer Services"),
                             Sciences = c("Agriculture & Natural Resources", "Biology & Life Science", "Health", "Physical Sciences", "Social Science", "Psychology & Social Work"),
                             STEM = c("Computers & Mathematics", "Engineering"),
                             Business = c("Business", "Communications & Journalism"),
                             Social_Science = c("Law & Public Policy", "Education" , "Communications & Journalism"),
                             Misc = c("Interdisciplinary"))

# Making new column to find percent of graduates with low wage job
majors_raw <- majors_raw %>%
  mutate('pct_low_wage' = Low_wage_jobs / Total)
```


```{r, warning=FALSE, message=FALSE}

# Average percent of low wage job graduates for each major
majors_low_wage <- majors_raw %>%
  group_by(Major_Categories) %>%
  summarise('Low_Wage' = mean(pct_low_wage))

# Creating plot
ggplot(data = majors_low_wage, aes(x = Major_Categories, y = Low_Wage, fill = Major_Categories)) + geom_bar(stat = 'identity') +
  labs(x = 'Major Category', y = '% in Low Wage Jobs') + theme(legend.position = 'none')
```

The plot I created is a bar plot showing the percentage of students in each major that ended up with a low wage job. From the plot, we can see that STEM majors have the lowest percentage of graduates with low wage jobs, while the arts major group has the highest percentage of graduates with low wage jobs. This plot and the findings support the presenter's arguments that STEM majors tend to have the most financial stability among recent graduates, while more art-focused majors tend to have less financial stability.

### Presentation 2: How Different Factors Affect Life Expectancy Around the World by Rachael Cooper

This presentation focuses on the topic of life expectancy's relation to economic, socioeconomic, and global health factors among countries across the world. The key plots found in the presentation include scatterplots between GDP and education and life expectancy, a box plot for life expectancy among developed and developing nations from 2000 to 2015, and a series of scatterplots for immunizations/diseases with life expectancy. The main findings were life expectancy does in fact increase as GDP increases, there is an effect of health inequality, and increasing life expctancy as years pass.

```{r, warning=FALSE, message=FALSE}
# Read in data / prep
data <- read.csv("/Users/johnhope/Desktop/DS3003/Assignment 8/Data/Life Expectancy Data.csv")
data <- na.omit(data)
```

```{r, warning=FALSE, message=FALSE}

#Create plot
ggplot(data[data$Year == 2014,], aes(x = Total.expenditure, y = Life.expectancy, color = Status)) + 
  geom_point(alpha = 0.6) + facet_wrap(~ Status) + geom_smooth(method = 'lm', se = F) + 
  labs(title = '2014 Health Expenditure and Life Expectancy', x = 'Percent Expenditure on Health', y = 'Average Life Expectancy') +
  theme(legend.position = 'none')
```

The plot I created focuses on how government spending on health and life expectancy for developed and developing nations. I subsetted the dataset to 2014 for a single year of complete data. We see that in both developed and developing nations, when governments spend a greater percentage of their expenditures on health, life expectancy tends to increase. The pattern appears to be more apparent in the developing nations. The findings from this plot supports the presenters arguments. When countries are in better economic status with capability of allocating funds and resources towards public health, life expectancy tends to increase.

## Create your own plots for two presentations on Feb 23 (4 pts)
 
### Presentation 1: Mental Health in the Tech Industry by Hayden French

This presentation focuses on the current situation of mental health in the tech industry. Rates of mental illness tend to be much higher in the tech industry population compared to the general population, likely due to the fast pace and high levels of stress. The presentation focuses on survey answers from people within the tech industry regarding mental health, availability of resources, and effects. The plots included are series of bar plots, showing mental health care benfits based on company size, ease of asking for medical leave with resources provided, and the effect of mental health issue with remote/in person work status. The main findings were that bigger firms provided more resources, more resources means more easy to take leave, and in-person workers feel more that mental illness would hurt career.

```{r, warning=FALSE, message=FALSE}
# Read in data / prep
df <- read.csv('/Users/johnhope/Desktop/DS3003/Assignment 8/Data/final_survey_cleaned.csv')
df <- df[which(df$Self.Employed == 'No' & df$Tech.Company == 'Yes'),]
df <- subset(df, select = -c(Self.Employed, Tech.Company) )  # Removing now-useless columns
rownames(df) <- NULL # Reset index
```

```{r, warning=FALSE, message=FALSE}
# Subset to the six countries of interest
countries <- c('United States of America', 'United Kingdom', 'Germany', 'Australia', 'Netherlands', 'Sweden')
df <- df[df$Country %in% countries,]
```

```{r, warning=FALSE, message=FALSE}
# Create plot
ggplot(df, aes(x = Q1, group = Country, fill = Q1)) +  geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") + 
  geom_text(aes(label = scales::percent(..prop..), y= ..prop.. ), stat= "count", size = 3, vjust = -.3) + facet_wrap(~Country) +
  theme(axis.ticks.x = element_blank(), axis.text.x = element_blank(), plot.title = element_text(size=12)) + 
  scale_y_continuous(limits = c(0,0.65)) + scale_fill_discrete(name = "Response", labels = c("I don't know", "No", "Not eligible/N/A", "Yes")) + 
  labs(y = 'Proportion', title = 'Does Your Employer Provide Mental Health Benefits as Part of its Healthcare Coverage?')
```

To further look into the issue, I wanted to see if certain countries tech workers were provided more mental health resources. I subsetted the data to include the six countries with the most people in this sample. We can see the percentage of each response to the titled question for each country. From this plot, we can see that the U.S. overwhelmingly provides much more mental health benefits in their helth care coverage for tech workers comapred to other countries. This may go against the argument of the article, which focuses on the mental health of the U.S. tech indsutry in specific. The U.S. tends to provided much more resources, so the U.S. should see less rates of mental illness among tech workers, but this is not the case.

### Presentation 2: Examining Miamiâ€™s Housing Market by Thomas Burrell

This presentation focuses on the real estate situation in Miami. Miami is the 2nd most expensive residential real estate market in the country, so this presentation tries to gather the extent of the housing market situation and why this is happening. The main findings here were home price is correlated to the square footage of the house, and that structure quality is an important factor in home price. The plots found in the presentation include a histogram of sale prices, a scatterplot between house sqaure footage and price, box plots of age and quality versus price, and bar plot of quality counts.

```{r, warning=FALSE, message=FALSE}
# Read in data
miami <- read.csv("/Users/johnhope/Desktop/DS3003/Assignment 8/Data/miami-housing.csv")

# Bin the data into factors based on distance to ocean
miami$OCEAN_DIST <- cut(x = miami$OCEAN_DIST, breaks = c(0, 5280, 26400, 52800, Inf))
levels(miami$OCEAN_DIST) <- c('0 to 1 Miles', '1 to 5 Miles', '5 to 10 Miles', '10+ Miles')
```


```{r, warning=FALSE, message=FALSE}
# Create plot
ggplot(miami, aes(x  = OCEAN_DIST, y = SALE_PRC, fill = OCEAN_DIST)) + geom_bar(stat = 'summary', fun.y = 'mean') + 
  theme(legend.position = 'none') + labs(x = 'Distance to Ocean', y = 'Average Sale Price (in $)') + 
    stat_summary(aes(label=round(..y.., 2)), vjust = -0.3, geom = "text", fun = mean)
```

An interesting varible I wanted to explore was the house distance to ocean, and how this may have an effect on sale price. The above plot is a bar plot showing average sale price for homes based on distance to ocean. We see that homes within a mile of the ocean tend to overwhelmingly have the highest sale prices, of nearly 1 million dollars. The other homes with farther distances tend to have much more normal sales prices in comparison. The findings of this plot can add to the presenter's argument regrding why the Miami housing market is so expensive. Real estate located near the ocean may tend to have higher sales prices. Therefore, if Miami is one of the only major cities with a lot of houses located dirctly next to the ocean, this may give some insight into why the average prices of homes are so high.